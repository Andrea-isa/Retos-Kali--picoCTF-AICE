# b00tl3gRSA2
## Objetivo
In RSA d is a lot bigger than e, why don't we use d to encrypt instead of e? Connect with `nc jupiter.challenges.picoctf.org 18243`.

## Soluciòn

Antes de dar la soluciòn,  debemos tener encuenta estos puntos para poder dar respuesta:
```text
c - texto cifrado
m - mensajo en texto plano (lo que se va encriptar)
p - primo 1
q - primo 2
n - modulo
tn - totient n (euler)
e - exponente (llave publica, suele ser 216 + 1=65537 )

e=65537

d - llave privada
```
Y estas operaciones base son las que necesitaremos:
```text
n = p * q
tn = (p-1)*(q-1)
d = e mod inv tn / python -> inverse(e,tn)

Encriptar
c = m^e mod n / python -> pow(m,e,n)

Desencriptar
m = c^d mod n / python -> pow(c,d,n)
```

```bash
┌──(kali㉿kali)-[~/…/CarpetaCompartida.Windows/RetosKali-exam--editar/CarpetaKali-exam1/Retos-Crypto picoCTF 2019]
└─$ nc jupiter.challenges.picoctf.org 18243
c: 24013742558040246389389254559337436292156224638828138673460793941016149525390036953823743431145614579767077922796547071085891228036033745140487163117083060165968516116063964911694568568773895307973417949606342173311818770242844323155200018985982874072753981281676045336591752999474038823932205719662084739179
n: 71304506681169425428312422089662144315018071538129058194887638106074611539182486439569181019902336501138399219401954526600175003243576095032122614218438366839995882962926034943097177960288490318047487102569447576890778255966480153478937510534667352086526378594927556903822179943059360650155195142756592493527
e: 18786562046839990675048760123627817048192884038770075649650195266453916374674824806628943172111229448481876486891581073451717682851012839051522974498524115948393236984589560197007841787174954544256045885488146842304745443670510662836577879175949094593752105845508573130544455398461383776147829432874434063193

┌──(kali㉿kali)-[~/…/CarpetaCompartida.Windows/RetosKali-exam--editar/CarpetaKali-exam1/Retos-Crypto picoCTF 2019]
└─$  
```

Antes de pasar a la soluciòn en python, debemos saber que este reto tiene una seguridad extra, asì que, cambiambos 'e' por 'd', y a 'e' le asignamos como valor predeterminado 65537. Cuando usemos la formùla para desencriptar vamos a intercambiar tambièn la 'd' por la 'e', de modo que quede asì: m=pow(c,e,n).

```python

┌──(kali㉿kali)-[~/…/CarpetaCompartida.Windows/RetosKali-exam--editar/CarpetaKali-exam1/Retos-Crypto picoCTF 2019]
└─$ python
Python 3.10.5 (main, Jun  8 2022, 09:26:22) [GCC 11.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> c=24013742558040246389389254559337436292156224638828138673460793941016149525390036953823743431145614579767077922796547071085891228036033745140487163117083060165968516116063964911694568568773895307973417949606342173311818770242844323155200018985982874072753981281676045336591752999474038823932205719662084739179
>>> n=71304506681169425428312422089662144315018071538129058194887638106074611539182486439569181019902336501138399219401954526600175003243576095032122614218438366839995882962926034943097177960288490318047487102569447576890778255966480153478937510534667352086526378594927556903822179943059360650155195142756592493527
>>> d=18786562046839990675048760123627817048192884038770075649650195266453916374674824806628943172111229448481876486891581073451717682851012839051522974498524115948393236984589560197007841787174954544256045885488146842304745443670510662836577879175949094593752105845508573130544455398461383776147829432874434063193
>>> e=65537
>>> m=pow(c,d,n)
>>> m
28004089137275790818928006415228188519426270289685813544178652541186182329466563113511931910778223161712601783067409984901028965440139838519014941262977993881751727132565561634069202331671884376205513981180447347227928319335899877535489002384490236247369002072494640267955841659486325425958554538712944541660
>>> from Crypto.Util.number import long_to_bytes
>>> long_to_bytes(m)
b"'\xe1\x0f\xc1\x90\xb1\x0e4\xa3T*O\xd2-\xec\xd6DXU\x87\xca\n&\xdc\x9b\x13\x8c\xa2\xb9\xaaR\xd7\xbd\xba5+{\x82\x95\t\xaaZ\xeb\\\xf4\xf3\xe2\xd3\xdb\xd4\xd9\xc7i\xd9\x11\xcd\x86\xb4\x87\xf1\xdaW|{\xb7\xf1\xa5\x08Xb\xf2\x13\xb5X\xe8b\xbd\\\x7f}\x1c!/\x8a\xd1\xe0\x04\x91\xe0\xc3xCS>\x10\x19R\xedUE\xf4\xe0B\xc7\xc1\xbaq[\x06\x82\x9f\xd2,R\xd3\xce\x90X\xc5\xfb)\xaf\xcb+\x0c\x1a\xff\xdc"
>>> m=pow(c,e,n)
>>> long_to_bytes(m)
b'picoCTF{bad_1d3a5_4783252}'
>>>
```

picoCTF{bad_1d3a5_4783252}

## Referencias
- []()