# No Padding, No Problem
## Objetivo
Oracles can be your best friend, they will decrypt anything, except the flag's ciphertext. How will you break it? Connect with `nc mercury.picoctf.net 60368`.

## Soluciòn

Antes de dar la soluciòn,  debemos tener encuenta estos puntos para poder dar respuesta:
```text
c - texto cifrado
m - mensajo en texto plano (lo que se va encriptar)
p - primo 1
q - primo 2
n - modulo
tn - totient n (euler)
e - exponente (llave publica, suele ser 216 + 1=65537 )
d - llave privada
```
Y estas operaciones base son las que necesitaremos:
```text
n = p * q
tn = (p-1)*(q-1)
d = e mod inv tn / python -> inverse(e,tn)

Encriptar
c = m^e mod n / python -> pow(m,e,n)

Desencriptar
m = c^d mod n / python -> pow(c,d,n)


Homomorfico:
encriptar(m1) * encriptar(m2) = encriptar(m1 * m2*)

```

```shell
┌──(kali㉿kali)-[~/…/CarpetaCompartida.Windows/RetosKali-exam--editar/CarpetaKali-exam1/Retos-Crypto picoCTF 2021]
└─$ nc mercury.picoctf.net 60368
Welcome to the Padding Oracle Challenge
This oracle will take anything you give it and decrypt using RSA. It will not accept the ciphertext with the secret message... Good Luck!


n: 90303301394871175055687033369441842720202372496501462114934313067753753635781527483345622437437860801808697393422753448888735796390016645828272256162665261236915092801005081284294463395155030716996178482434983543487221243632752380998280362869306583346951436935579965790298109988491134737328334514902436401001
e: 65537
ciphertext: 69622191396660981483151421156685141788662003472987041225683096353102742981542903504005430505202693171276740069121711459456385150858700334189260315704154951986216159387324582147348710241618405895241752195916671220302716330884489529447400294769652130829576072874657351371355687450384956599618224257412492292280


Give me ciphertext to decrypt: 2574968181537299545968233288435845195141309563281359200910833199875751072786907288749678642023803037913564187633943390913952359166672982376375241110648700645257409037798810983659474244935301113398598737199790074368053456982110665814944212265305278572337305476698106357162017674942614510089782635778597424896345593077836530353939097845784332808685461642402933522145103442532515564544650362615855549266571249491646283729500119979439410858576323524003489630184132521467112851636722063836143383786921488359664378630274796179949700647609513484822139310139148794334112716797301629680607071337797257584584487847405419208960
Here you go: 580550060391700078946913236734911770139931497702556153513487440893406629034802718534645538074938502890769138695361576199930
Give me ciphertext to decrypt:                                                                                                                                                                        
┌──(kali㉿kali)-[~/…/CarpetaCompartida.Windows/RetosKali-exam--editar/CarpetaKali-exam1/Retos-Crypto picoCTF 2021]
└─$ 
```

```python
┌──(kali㉿kali)-[~/…/CarpetaCompartida.Windows/RetosKali-exam--editar/CarpetaKali-exam1/Retos-Crypto picoCTF 2021]
└─$ python
Python 3.10.5 (main, Jun  8 2022, 09:26:22) [GCC 11.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> n=90303301394871175055687033369441842720202372496501462114934313067753753635781527483345622437437860801808697393422753448888735796390016645828272256162665261236915092801005081284294463395155030716996178482434983543487221243632752380998280362869306583346951436935579965790298109988491134737328334514902436401001
>>> e=65537
>>> c=69622191396660981483151421156685141788662003472987041225683096353102742981542903504005430505202693171276740069121711459456385150858700334189260315704154951986216159387324582147348710241618405895241752195916671220302716330884489529447400294769652130829576072874657351371355687450384956599618224257412492292280
>>> x=pow(2,e,n)
>>> c * x
2574968181537299545968233288435845195141309563281359200910833199875751072786907288749678642023803037913564187633943390913952359166672982376375241110648700645257409037798810983659474244935301113398598737199790074368053456982110665814944212265305278572337305476698106357162017674942614510089782635778597424896345593077836530353939097845784332808685461642402933522145103442532515564544650362615855549266571249491646283729500119979439410858576323524003489630184132521467112851636722063836143383786921488359664378630274796179949700647609513484822139310139148794334112716797301629680607071337797257584584487847405419208960
>>> m=580550060391700078946913236734911770139931497702556153513487440893406629034802718534645538074938502890769138695361576199930 // 2
>>> from Crypto.Util.number import long_to_bytes
>>> long_to_bytes(m)
b'picoCTF{m4yb3_Th0se_m3s54g3s_4r3_difurrent_3279013}'
>>> 
```
picoCTF{m4yb3_Th0se_m3s54g3s_4r3_difurrent_3279013}

## Referencias
- []()